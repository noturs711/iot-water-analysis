<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Analysis</title>
</head>
<body>
    <h1>Create a New Table</h1>
    <form id="createTableForm">
        <label for="tableName">Table Name:</label>
        <input type="text" id="tableName" name="tableName" required>
        <button type="submit">Create Table</button>
    </form>

    <p id="result"></p>

    <script>
        document.getElementById('createTableForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const tableName = document.getElementById('tableName').value;
            
            fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ tableName: tableName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.tableName) {
                    document.getElementById('result').innerText = `Table "${data.tableName}" created successfully!`;
                } else {
                    document.getElementById('result').innerText = `Error: ${data.error}`;
                }
            })
            .catch(error => {
                document.getElementById('result').innerText = `Error: ${error.message}`;
            });
        });
    </script>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Analysis</title>
</head>
<body>
    <h1>Create a New Table</h1>
    <form id="createTableForm">
        <label for="tableName">Table Name:</label>
        <input type="text" id="tableName" name="tableName" required>
        <button type="submit">Create Table</button>
    </form>

    <p id="result"></p>

    <script>
        document.getElementById('createTableForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const tableName = document.getElementById('tableName').value;
            
            fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ tableName: tableName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.tableName) {
                    document.getElementById('result').innerText = `Table "${data.tableName}" created successfully!`;
                } else {
                    document.getElementById('result').innerText = `Error: ${data.error}`;
                }
            })
            .catch(error => {
                document.getElementById('result').innerText = `Error: ${error.message}`;
            });
        });
    </script>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Analysis</title>
</head>
<body>
    <h1>Create a New Table</h1>
    <form id="createTableForm">
        <label for="tableName">Table Name:</label>
        <input type="text" id="tableName" name="tableName" required>
        <button type="submit">Create Table</button>
    </form>

    <p id="result"></p>

    <script>
        document.getElementById('createTableForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const tableName = document.getElementById('tableName').value;
            
            fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ tableName: tableName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.tableName) {
                    document.getElementById('result').innerText = `Table "${data.tableName}" created successfully!`;
                } else {
                    document.getElementById('result').innerText = `Error: ${data.error}`;
                }
            })
            .catch(error => {
                document.getElementById('result').innerText = `Error: ${error.message}`;
            });
        });
    </script>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Analysis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="text"], input[type="submit"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Water Analysis</h1>


        <div class="form-group">
            <label for="tableName">Create Table</label>
            <input type="text" id="tableName" placeholder="Enter table name">
            <input type="submit" value="Create Table" onclick="createTable()">
        </div>

        <h2>Data</h2>
        <table id="dataTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>TDS</th>
                    <th>Turbidity</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                Data will be inserted here -->
            <!-- </tbody>
        </table>
    </div>

    <script>
        document.getElementById('createTableForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const tableName = document.getElementById('tableName').value;
            
            fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ tableName: tableName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.tableName) {
                    document.getElementById('result').innerText = `Table "${data.tableName}" created successfully!`;
                } else {
                    document.getElementById('result').innerText = `Error: ${data.error}`;
                }
            })
            .catch(error => {
                document.getElementById('result').innerText = `Error: ${error.message}`;
            });
        });
    </script>
</body>
</html>  -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Analysis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="text"], input[type="submit"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Water Analysis</h1>

        <div class="form-group">
            <label for="tableName">Create Table</label>
            <input type="text" id="tableName" placeholder="Enter table name">
            <input type="submit" value="Create Table" onclick="createTable()">
        </div>

        <h2>Data</h2>
        <table id="dataTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>TDS</th>
                    <th>Turbidity</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data will be inserted here -->
            </tbody>
        </table>
    </div>

    <!-- <script>
        async function createTable() {
            const tableName = document.getElementById('tableName').value;
            const response = await fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ tableName: tableName }),
            });

            const result = await response.json();
            if (result.tableName) {
                alert(`Table created: ${result.tableName}`);
                fetchData(); // Fetch and display data after table creation
            } else {
                alert(`Error: ${result.error}`);
            }
        }

        async function fetchData() {
            const response = await fetch('/data');
            const data = await response.json();

            const tbody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';

            data.forEach((row) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.id}</td>
                    <td>${row.tds}</td>
                    <td>${row.turbidity}</td>
                    <td>${row.date}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Fetch data on page load
        
        window.onload = fetchData;
    </script>
     -->
     <script>
        async function createTable() {
            const tableName = document.getElementById('tableName').value;
            const response = await fetch('/create-table', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ tableName: tableName }),
            });
    
            const result = await response.json();
            if (result.tableName) {
                alert(`Table created: ${result.tableName}`);
                clearTable(); // Clear the table before fetching new data
                fetchData(); // Fetch and display data after table creation
            } else {
                alert(`Error: ${result.error}`);
            }
        }
    
        async function fetchData() {
            const response = await fetch('/data');
            const data = await response.json();
    
            const tbody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
    
            if (data.length === 0) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td colspan="4">No data available</td>
                `;
                tbody.appendChild(tr);
            } else {
                data.forEach((row) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${row.id}</td>
                        <td>${row.tds}</td>
                        <td>${row.turbidity}</td>
                        <td>${row.date}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }
        }
    
        function clearTable() {
            const tbody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // Clear the table contents
        }
    
        // Fetch data on page load
        window.onload = fetchData;
        function autoRefresh(interval) {
            updateData(); // Update immediately on load

            // Set interval to refresh data periodically
            setInterval(() => {
                updateData();
            }, interval);
        }

        // Call autoRefresh with a 5-second interval (5000 milliseconds)
        autoRefresh(5000); 
    </script>
    
</body>
</html>
